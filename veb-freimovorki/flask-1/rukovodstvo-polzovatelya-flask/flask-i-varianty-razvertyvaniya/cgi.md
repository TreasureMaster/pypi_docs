# CGI

Если все остальные методы развертывания не работают, **CGI** точно сработает. **CGI** поддерживается всеми основными серверами, но обычно имеет неоптимальную производительность.

Таким же образом можно использовать приложение **Flask** в Google [App Engine](https://cloud.google.com/appengine/docs/), где выполнение происходит в среде, подобной **CGI**.

{% hint style="info" %}
**Осторожно:**

Заранее убедитесь, что любые вызовы **app.run ()**, которые могут быть в вашем файле приложения, находятся внутри блока `if name == 'main':` или перемещены в отдельный файл. Просто убедитесь, что он не вызывается, потому что при этом всегда будет запускаться локальный сервер **WSGI**, который нам не нужен, если мы развернем это приложение на **CGI** / **app engine**.

При использовании **CGI** вам также необходимо убедиться, что ваш код не содержит каких-либо операторов **print** или что **sys.stdout** замещается чем-то, что не записывается в ответ HTTP.
{% endhint %}

## Создание файла .cgi

Сначала вам нужно создать файл приложения **CGI**. Назовем его `yourapplication.cgi`:

```python
#!/usr/bin/python
from wsgiref.handlers import CGIHandler
from yourapplication import app

CGIHandler().run(app)
```

## Настройка сервера

Обычно есть два способа настроить сервер. Либо просто скопируйте `.cgi` в `cgi-bin` (и используйте **mod\_rewrite** или что-то подобное для перезаписи URL), либо позвольте серверу указывать на файл напрямую.

Например, в **Apache** вы можете поместить в конфигурацию что-то вроде этого:

```perl
ScriptAlias /app /path/to/the/application.cgi
```

Однако на общем веб-хостинге у вас может не быть доступа к вашей конфигурации **Apache**. В этом случае файл с именем `.htaccess`, находящийся в общедоступном каталоге, в котором вы хотите, чтобы ваше приложение было доступно, тоже работает, но директива **ScriptAlias** в этом случае не будет работать:

```perl
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f # Не мешайте статическим файлам
RewriteRule ^(.*)$ /path/to/the/application.cgi/$1 [L]
```

Для получения дополнительной информации обратитесь к документации вашего веб-сервера.
