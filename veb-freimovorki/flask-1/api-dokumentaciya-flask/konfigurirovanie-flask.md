# Конфигурирование Flask

## Класс flask.Config( _root\_path_, _defaults=None_ )

Работает точно так же, как **dict**, но позволяет заполнять его из файлов или специальных словарей. Есть два общих шаблона для заполнения конфигурации.

Либо вы можете залить **config** из конфигурационного файла:

```python
app.config.from_pyfile('yourconfig.cfg')
```

Или, в качестве альтернативы, вы можете определить параметры конфигурации в модуле, который вызывает [from\_object ()](konfigurirovanie-flask.md#from\_object), или указать путь импорта к модулю, который должен быть загружен. Также можно указать ему использовать тот же модуль и с его помощью указать значения конфигурации непосредственно перед вызовом:

```python
DEBUG = True
SECRET_KEY = 'development key'
app.config.from_object(__name__)
```

В обоих случаях (загрузка из любого файла Python или загрузка из модулей) в конфигурацию добавляются только ключи верхнего регистра. Это позволяет использовать строчные значения в файле конфигурации для временных значений, которые не добавляются в конфигурацию, или определять ключи конфигурации в том же файле, который реализует приложение.

Вероятно, наиболее интересный способ загрузки конфигураций - это использование переменной окружения, указывающей на файл:

```python
app.config.from_envvar('YOURAPPLICATION_SETTINGS')
```

В этом случае перед запуском приложения вы должны установить эту переменную среды в файл, который вы хотите использовать. В Linux и OS X используйте оператор **export**:

```bash
export YOURAPPLICATION_SETTINGS='/path/to/config/file'
```

В Windows используйте вместо этого **set**.

**Параметры:**

* **root\_path** - путь, относительно которого считываются файлы. Когда объект конфигурации создается приложением, это [root\_path](obekt-prilozheniya-flask.md#root\_path-none) приложения.
* **defaults** - необязательный словарь значений по умолчанию

### from\_envvar( _variable\_name_, _silent=False_ )

Загружает конфигурацию из переменной среды, указывающей на файл конфигурации. По сути, это просто ярлык с более красивыми сообщениями об ошибках для этой строки кода:

```python
app.config.from_pyfile(os.environ['YOURAPPLICATION_SETTINGS'])
```

**Параметры:**

* **variable\_name** - имя переменной окружения
* **silent** - установите значение `True`, если вы хотите, чтобы отсутствующие файлы не отображались без уведомления.

**Возвращает:**

* **bool**. `True`, если можно загрузить конфигурацию, иначе - `False`.

### from\_json( _filename_, _silent=False_ )

_Новое в версии 0.11_.

Обновляет значения в конфигурации из файла **JSON**. Эта функция ведет себя так, как если бы объект **JSON** был словарем и передан в функцию [from\_mapping ()](konfigurirovanie-flask.md#from\_mapping).

**Параметры:**

* **filename** - имя файла **JSON**. Это может быть либо абсолютное имя файла, либо имя файла относительно корневого пути.
* **silent** - установите значение `True`, если вы хотите, чтобы отсутствующие файлы не отображались без уведомления.

### from\_mapping( _\*mapping_, _\*\*kwargs_ )

_Новое в версии 0.11_.

Обновляет конфигурацию, например **update ()**, игнорируя элементы с не верхними клавишами.

### from\_object( _obj_ )

Обновляет значения из данного объекта. Объект может быть одного из следующих двух типов:

* строка: в этом случае будет импортирован объект с таким именем
* фактическая ссылка на объект: этот объект используется напрямую

Объекты обычно представляют собой модули или классы. **from\_object ()** загружает только атрибуты модуля / класса в верхнем регистре. Объект **dict** не будет работать с **from\_object ()**, потому что ключи **dict** не являются атрибутами класса **dict**.

Пример модульной конфигурации:

```python
app.config.from_object('yourapplication.default_config')
from yourapplication import default_config
app.config.from_object(default_config)
```

Перед загрузкой с объектом ничего не делается. Если объект является классом и имеет атрибуты `@property`, его необходимо создать перед передачей в этот метод.

Эту функцию следует использовать не для загрузки фактической конфигурации, а для загрузки значений конфигурации по умолчанию. Фактическая конфигурация должна быть загружена с помощью [from\_pyfile ()](konfigurirovanie-flask.md#from\_pyfile) и в идеале из места, не входящего в пакет, потому что пакет может быть установлен в масштабе всей системы.

См. в разделе «[Разработка / производство](../rukovodstvo-polzovatelya-flask/obrabotka-konfiguracii-flask.md#razrabotka-proizvodstvo)» пример конфигурации на основе классов с использованием **from\_object ()**.

**Параметры:** _**obj**_ - имя или объект импорта

### from\_pyfile( _filename_, _silent=False_ )

Обновляет значения в конфигурации из файла Python. Эта функция ведет себя так, как если бы файл был импортирован как модуль с помощью функции [from\_object ()](konfigurirovanie-flask.md#from\_object-obj).

**Параметры:**

* **filename** - имя файла конфигурации. Это может быть либо абсолютное имя файла, либо имя файла относительно корневого пути.
* **silent** - установите значение `True`, если вы хотите, чтобы отсутствующие файлы не отображались без уведомления.

_Новое в версии 0.7:_ параметр _**silent**_.

### get\_namespace( _namespace_, _lowercase=True_, _trim\_namespace=True_ )

_Новое в версии 0.11_.

Возвращает словарь, содержащий подмножество параметров конфигурации, соответствующих указанному пространству имен / префиксу. Пример использования:

```python
app.config['IMAGE_STORE_TYPE'] = 'fs'
app.config['IMAGE_STORE_PATH'] = '/var/app/images'
app.config['IMAGE_STORE_BASE_URL'] = 'http://img.website.com'
image_store_config = app.config.get_namespace('IMAGE_STORE_')
```

Результирующий словарь _**image\_store\_config**_ будет выглядеть так:

```python
{
    'type': 'fs',
    'path': '/var/app/images',
    'base_url': 'http://img.website.com'
}
```

Это часто бывает полезно, когда параметры конфигурации отображаются непосредственно на аргументы ключевого слова в функциях или конструкторах классов.

**Параметры:**

* **namespace** - пространство имен конфигурации
* **lowercase** - флаг, указывающий, должны ли ключи результирующего словаря быть строчными
* **trim\_namespace** - флаг, указывающий, не должны ли ключи результирующего словаря включать пространство имен
