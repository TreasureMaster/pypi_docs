# API интерфейса командной строки Flask

## Класс flask.cli.FlaskGroup( _add\_default\_commands=True_, _create\_app=None_, _add\_version\_option=True_, _load\_dotenv=True_, _set\_debug\_flag=True_, _\*\*extra_ )

Специальный подкласс группы [AppGroup](interfeis-komandnoi-stroki-flask.md#klass-flask-cli-appgroup), который поддерживает загрузку дополнительных команд из настроенного приложения **Flask**. Обычно разработчику не нужно взаимодействовать с этим классом, но есть несколько очень сложных вариантов использования, для которых имеет смысл создать экземпляр этого класса.

Для получения информации о том, почему это полезно, см. [пользовательские сценарии](../rukovodstvo-polzovatelya-flask/interfeis-komandnoi-stroki-flask.md#polzovatelskie-skripty).

### Параметры flask.cli.FlaskGroup

* _**add\_default\_commands**_ - если это `True`, то будут добавлены команды запуска и оболочки по умолчанию.
* _**add\_version\_option**_ - добавляет параметр `--version`.
* _**create\_app**_ - необязательный обратный вызов, который передает информацию о скрипте и возвращает загруженное приложение.
* _**load\_dotenv**_ - Загружает ближайшие файлы `.env` и `.flaskenv`, чтобы установить переменные среды. Также изменит рабочий каталог на каталог, содержащий первый найденный файл.
* _**set\_debug\_flag**_ - Устанавливает флаг отладки приложения в зависимости от активной среды.

_Изменено в версии 1.0:_ если он установлен, **python-dotenv** будет использоваться для загрузки переменных среды из файлов `.env` и `.flaskenv`.

### get\_command( _ctx_, _name_ )

Учитывая контекст и имя команды, это возвращает объект **Command**, если он существует, или возвращает `None`.

### list\_commands( _ctx_ )

Возвращает список имен подкоманд в том порядке, в котором они должны появляться.

### main( _\*args_, _\*\*kwargs_ )

Это способ вызвать скрипт со всеми наворотами как приложение командной строки. Это всегда завершает работу приложения после вызова. Если это не нужно, нужно перехватить **SystemExit**.

Этот метод также доступен при прямом вызове экземпляра **Command**.

_Новое в версии 3.0:_ добавлен флаг _**standalone\_mode**_ для управления автономным режимом.

**Параметры:**

* _**args**_ - аргументы, которые следует использовать для синтаксического анализа. Если не указан, используется `sys.argv [1:]`.
* _**prog\_name**_ - имя программы, которое следует использовать. По умолчанию имя программы создается на основе имени файла из `sys.argv [0]`.
* _**complete\_var**_ - переменная среды, которая контролирует поддержку завершения **bash**. По умолчанию это `"_<prog_name>_COMPLETE"` с _**prog\_name**_ в верхнем регистре.
* _**standalone\_mode**_ - по умолчанию сценарий запускается в автономном режиме. Затем щелчок обработает исключения и преобразует их в сообщения об ошибках, и функция никогда не вернется, но завершит интерпретатор. Если установлено значение `False`, они будут переданы вызывающей стороне, а возвращаемое значение этой функции - это возвращаемое значение **invoke ()**.
* _**extra**_ - дополнительные аргументы ключевого слова передаются конструктору контекста. См. **Context** для получения дополнительной информации.

## Класс flask.cli.AppGroup( _name=None_, _commands=None_, _\*\*attrs_ )

Это работает аналогично обычной [Group](https://click.palletsprojects.com/en/7.x/api/#click.Group) из **Click**, но меняет поведение декоратора [command ()](interfeis-komandnoi-stroki-flask.md#command), так что он автоматически обертывает функции в [with\_appcontext ()](interfeis-komandnoi-stroki-flask.md#flask-cli-with\_appcontext).

Не путать с [FlaskGroup](interfeis-komandnoi-stroki-flask.md#klass-flask-cli-flaskgroup-add\_default\_commands-true-create\_app-none-add\_version\_option-true-load\_dotenv-true-set\_debug\_flag-true-extra).

### command( _\*args_, _\*\*kwargs_ )

Это работает точно так же, как одноименный метод для обычного [click.Group](https://click.palletsprojects.com/en/7.x/api/#click.Group), но он обертывает обратные вызовы в [with\_appcontext ()](interfeis-komandnoi-stroki-flask.md#flask-cli-with\_appcontext), если он не отключен передачей `with_appcontext = False`.

### group( _\*args_, _\*\*kwargs_ )

Это работает точно так же, как одноименный метод при обычном [click.Group](https://click.palletsprojects.com/en/7.x/api/#click.Group), но по умолчанию для класса группы используется [AppGroup](interfeis-komandnoi-stroki-flask.md#klass-flask-cli-appgroup-name-none-commands-none-attrs).

## Класс flask.cli.ScriptInfo( _app\_import\_path=None_, _create\_app=None_, _set\_debug\_flag=True_ )

Вспомогательный объект для работы с приложениями **Flask**. Обычно нет необходимости взаимодействовать с ним, так как он используется для внутренней отправки, чтобы **click**. В будущих версиях **Flask** этот объект, скорее всего, будет играть большую роль. Обычно он создается [FlaskGroup](interfeis-komandnoi-stroki-flask.md#klass-flask-cli-flaskgroup-add\_default\_commands-true-create\_app-none-add\_version\_option-true-load\_dotenv-true-set\_debug\_flag-true-extra) автоматически, но вы также можете создать его вручную и передать дальше как объект **click**.

### app\_import\_path _= None_

Необязательный путь импорта для приложения **Flask**.

### create\_app _= None_

Необязательная функция, которой передается информация о скрипте для создания экземпляра приложения.

### data _= None_

Словарь с произвольными данными, которые можно связать с этой информацией скрипта.

### load\_app()

Загружает приложение **Flask** (если еще не загружено) и возвращает его. Вызов этого несколько раз просто приведет к возврату уже загруженного приложения.

## flask.cli.load\_dotenv( _path=None_ )

_Новое в версии 1.0_.

Загрузите файлы «**dotenv**» в порядке приоритета для установки переменных среды.

Если переменная _**env**_ уже установлена, она не перезаписывается, поэтому более ранние файлы в списке предпочтительнее более поздних файлов.

Изменяет текущий рабочий каталог на расположение первого найденного файла, предполагая, что он находится в каталоге проекта верхнего уровня и будет там, откуда путь Python должен импортировать локальные пакеты.

Это невозможно, если [python-dotenv](https://github.com/theskumar/python-dotenv#readme) не установлен.

**Параметры:** _**path**_ - вместо поиска загрузите файл в это место.

**Возвращает:** `True`, если файл был загружен.

_Изменено в версии 1.1.0:_ возвращает `False`, если **python-dotenv** не установлен или если указанный путь не является файлом.

## flask.cli.with\_appcontext( _f_ )

Оборачивает обратный вызов, чтобы он гарантированно выполнялся с контекстом приложения сценария. Если обратные вызовы регистрируются непосредственно в объекте `app.cli`, они по умолчанию обертываются этой функцией, если она не отключена.

## flask.cli.pass\_script\_info( _f_ )

Отмечает функцию так, чтобы экземпляр [ScriptInfo](interfeis-komandnoi-stroki-flask.md#klass-flask-cli-scriptinfo-app\_import\_path-none-create\_app-none-set\_debug\_flag-true) передавался в качестве первого аргумента обратному вызову **click**.

## flask.cli.run\_command _= \<Command run>_

Запускает локальный сервер разработки.

Этот сервер предназначен только для разработки. Он не обеспечивает стабильность, безопасность или производительность производственных серверов **WSGI**.

Перезагрузчик и отладчик включены по умолчанию, если **FLASK\_ENV = development** или **FLASK\_DEBUG = 1**.

## flask.cli.shell\_command _= \<Command shell>_

Запускает интерактивную оболочку Python в контексте данного приложения **Flask**. Приложение заполнит пространство имен по умолчанию этой оболочки в соответствии с ее конфигурацией.

Это полезно для выполнения небольших фрагментов кода управления без необходимости вручную настраивать приложение.
