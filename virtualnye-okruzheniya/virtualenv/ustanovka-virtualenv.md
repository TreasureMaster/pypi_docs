# Установка virtualenv

## Установка

### pipx

[virtualenv](https://pypi.org/project/virtualenv/) - это инструмент строки, для работы которого требуется интерпретатор Python. Если у вас уже есть интерпретатор `Python 3.5+`, лучше всего использовать [pipx](https://pypi.org/project/pipx/) для установки **virtualenv** в изолированной среде. Это дает дополнительное преимущество: позже вы сможете обновить **virtualenv**, не рассматривая другие части системы.

```bash
pipx install virtualenv
virtualenv --help
```

### pip

В качестве альтернативы вы можете установить его в самом глобальном интерпретаторе Python (возможно, как пользовательский пакет с помощью флага `--user`). Будьте осторожны, если вы используете установку Python, управляемую вашей операционной системой или другим менеджером пакетов. **pip** может не взаимодействовать с этими инструментами и может оставить вашу систему в несогласованном состоянии. Обратите внимание: если вы пойдете по этому пути, вам необходимо убедиться, что **pip** достаточно новый, как указано в подразделах ниже:

```bash
python -m pip install --user virtualenv
python -m virtualenv --help
```

### wheel

Для установки **virtualenv** через **wheel** (по умолчанию с **pip**) требуется установщик, который может понимать тег **python-requires** (см. [PEP-503](https://www.python.org/dev/peps/pep-0503/)), с **pip** это версия `9.0.0` (выпущена в ноябре 2016 г.). Кроме того, если вы не устанавливаете его через **PyPi**, вам необходимо использовать зеркало, которое правильно перенаправляет тег, требующий python (в частности, зеркала **OpenStack** этого не делают или более старые версии [devpi](https://github.com/devpi/devpi) - добавлены с версией `4.7.0` ).

### sdist

При установке через исходный дистрибутив вам понадобится установщик, который обрабатывает спецификацию [PEP-517](https://www.python.org/dev/peps/pep-0517/). В случае **pip** это версия `18.0.0` или более поздняя (выпущена в июле 2018 г.). Если вы не можете обновить свой пакет для поддержки этого, вам необходимо убедиться, что требования сборки из [pyproject.toml](https://github.com/pypa/virtualenv/blob/main/pyproject.toml#L2) удовлетворены, прежде чем запускать установку.

### zipapp

Вы можете использовать **virtualenv**, не устанавливая его. Мы публикуем [zipapp](https://docs.python.org/3/library/zipapp.html) для Python, вы можете просто загрузить его с [https://bootstrap.pypa.io/virtualenv.pyz](https://bootstrap.pypa.io/virtualenv.pyz) и вызвать этот пакет с помощью интерпретатора python:

```bash
python virtualenv.pyz --help
```

**zipapp** корневого уровня всегда является последней версией. Чтобы получить последний поддерживаемый **zipapp** для данного второстепенного выпуска python, используйте ссылку `https://bootstrap.pypa.io/virtualenv/x.y/virtualenv.pyz`, например для последнего **virtualenv**, поддерживающего Python 2.7, используйте [https://bootstrap.pypa.io/virtualenv/2.7/virtualenv.pyz](https://bootstrap.pypa.io/virtualenv/2.7/virtualenv.pyz).

### setup.py

Мы не рекомендуем и официально не поддерживаем этот метод. Лучше использовать установщик, поддерживающий интерфейс [PEP-517](https://www.python.org/dev/peps/pep-0517/), например `pip 19.0.0` или новее. При этом вы можете по-прежнему установить пакет с помощью этого метода, если вы удовлетворите зависимости сборки перед вызовом команды установки (как описано в разделе [sdist](ustanovka-virtualenv.md#sdist)).

### Последний неизданный

Не рекомендуется устанавливать невыпущенную версию, и ее следует выполнять только в целях тестирования. Если вы это сделаете, вам понадобится версия **pip** не ниже `18.0.0` и используйте следующую команду:

```bash
pip install git+https://github.com/pypa/virtualenv.git@main
```

## Совместимость с Python и ОС

**virtualenv** работает со следующими реализациями интерпретатора Python:

* [CPython](https://www.python.org/) версий 2.7, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9
* [PyPy](https://www.pypy.org/) 2.7 и 3.4+.

Это означает, что **virtualenv** работает с последней версией исправления каждой из этих дополнительных версий. Предыдущие версии исправлений поддерживаются по принципу «максимальных усилий».

**CPython** поставляется в нескольких формах, и каждая ОС переупаковывает его, часто применяя некоторые настройки по ходу дела. Поэтому мы не можем универсально сказать, что мы поддерживаем все платформы, а скорее указать те, на которых мы проводим тестирование. В случае тех, которые здесь не указаны, поддержка неизвестна, но, скорее всего, будет работать. Если вы обнаружите какие-то случаи, пожалуйста, отправьте запрос функции в нашем трекере проблем.

### Linux

* установки с [python.org](https://www.python.org/downloads/)
* Ubuntu 16.04+ (как восходящая, так и [деадснейковая](https://launchpad.net/\~deadsnakes/+archive/ubuntu/ppa) сборки)
* Fedora
* RHEL и CentOS
* OpenSuse
* Arch Linux

### macOS

В случае **macOS** мы поддерживаем:

* установки с [python.org](https://www.python.org/downloads/)
* версии python, установленные через [brew](https://docs.brew.sh/Homebrew-and-Python) (как старые python2.7, так и python3)
* Python 3, часть XCode (инфраструктура Python - `/Library/Frameworks/Python3.framework/`)
* Python 2, часть ОС (`/System/Library/Frameworks/Python.framework/Versions/`)

### Windows

* установки с [python.org](https://www.python.org/downloads/)
* Windows Store Python - обратите внимание только на [версию 3.7+](https://www.microsoft.com/en-us/p/python-38/9mssztt1n39l?activetab=pivot:overviewtab)

### Варианты упаковки

* Обычный вариант (файловая структура взята с [python.org](https://www.python.org/downloads/)).
* Мы поддерживаем системные установки CPython 2, которые не содержат файлы python для стандартной библиотеки, если присутствуют соответствующие скомпилированные файлы (например, только `os.pyc`, а не `os.py`). Это может использоваться пользовательскими системами, которые могут захотеть максимизировать доступное хранилище или скрыть исходный код, удалив файлы `.py`.
